{"remainingRequest":"C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\Users\\我是仙女\\Desktop\\jd\\src\\effects\\cartEffect.js","dependencies":[{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\src\\effects\\cartEffect.js","mtime":1655728658786},{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\babel.config.js","mtime":1654581884108},{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1654581870855},{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\babel-loader\\lib\\index.js","mtime":1654581871710},{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\eslint-loader\\index.js","mtime":1654581871051}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLnRvLWZpeGVkLmpzIjsKaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgY29tcHV0ZWQgfSBmcm9tICd2dWUnOyAvLyDotK3nianovabnm7jlhbPpgLvovpEgIOeCueWHu+WKoOWHj+WPtwoKZXhwb3J0IHZhciB1c2VDb21tb25DYXJ0RWZmZWN0ID0gZnVuY3Rpb24gdXNlQ29tbW9uQ2FydEVmZmVjdChzaG9wSWQpIHsKICB2YXIgc3RvcmUgPSB1c2VTdG9yZSgpOwogIHZhciBjYXJ0TGlzdCA9IHN0b3JlLnN0YXRlLmNhcnRMaXN0OyAvLyDojrflj5botK3nianovabmlbDmja4KCiAgdmFyIHByb2R1Y3RMaXN0ID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgdmFyIF9jYXJ0TGlzdCRzaG9wSWQ7CgogICAgdmFyIHByb2R1Y3RMaXN0ID0gKChfY2FydExpc3Qkc2hvcElkID0gY2FydExpc3Rbc2hvcElkXSkgPT09IG51bGwgfHwgX2NhcnRMaXN0JHNob3BJZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NhcnRMaXN0JHNob3BJZC5wcm9kdWN0TGlzdCkgfHwge307IC8vIGNvbnNvbGUubG9nKHByb2R1Y3RMaXN0KQoKICAgIHZhciBub3RFbXB0eVByb2R1Y3RMaXN0ID0ge307CgogICAgZm9yICh2YXIgaSBpbiBwcm9kdWN0TGlzdCkgewogICAgICB2YXIgcHJvZHVjdCA9IHByb2R1Y3RMaXN0W2ldOwoKICAgICAgaWYgKHByb2R1Y3QuY291bnQgPiAwKSB7CiAgICAgICAgbm90RW1wdHlQcm9kdWN0TGlzdFtpXSA9IHByb2R1Y3Q7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcHJvZHVjdExpc3Q7CiAgfSk7IC8vIOiOt+WPlnNob3BOYW1lCgogIHZhciBzaG9wTmFtZSA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgIHZhciBfY2FydExpc3Qkc2hvcElkMjsKCiAgICB2YXIgc2hvcE5hbWUgPSAoKF9jYXJ0TGlzdCRzaG9wSWQyID0gY2FydExpc3Rbc2hvcElkXSkgPT09IG51bGwgfHwgX2NhcnRMaXN0JHNob3BJZDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jYXJ0TGlzdCRzaG9wSWQyLnNob3BOYW1lKSB8fCAnJzsKICAgIHJldHVybiBzaG9wTmFtZTsKICB9KTsKCiAgdmFyIGNoYW5nZUNhcnRJdGVtSW5mbyA9IGZ1bmN0aW9uIGNoYW5nZUNhcnRJdGVtSW5mbyhzaG9wSWQsIHByb2R1Y3RJZCwgcHJvZHVjdEluZm8sIG51bSkgewogICAgLy8gY29uc29sZS5sb2coc2hvcElkKSAKICAgIC8vIGNvbW1pdCDlkIzmraXkv67mlLnmlbDmja4KICAgIHN0b3JlLmNvbW1pdCgnY2hhbmdlQ2FydEl0ZW1JbmZvJywgewogICAgICBzaG9wSWQ6IHNob3BJZCwKICAgICAgcHJvZHVjdElkOiBwcm9kdWN0SWQsCiAgICAgIHByb2R1Y3RJbmZvOiBwcm9kdWN0SW5mbywKICAgICAgbnVtOiBudW0KICAgIH0pOwogIH07IC8vIOS8mOWMluWkmuasoeeUqOWIsOeahHByb2R1Y3RMaXN0CgoKICB2YXIgY2FsY3VsYXRpb25zID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgdmFyIF9jYXJ0TGlzdCRzaG9wSWQzOwoKICAgIHZhciBwcm9kdWN0TGlzdCA9IChfY2FydExpc3Qkc2hvcElkMyA9IGNhcnRMaXN0W3Nob3BJZF0pID09PSBudWxsIHx8IF9jYXJ0TGlzdCRzaG9wSWQzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2FydExpc3Qkc2hvcElkMy5wcm9kdWN0TGlzdDsKICAgIHZhciByZXN1bHQgPSB7CiAgICAgIHRvdGFsOiAwLAogICAgICBwcmljZTogMCwKICAgICAgYWxsQ2hlY2tlZDogdHJ1ZQogICAgfTsgLy8g5oC75Lu25pWwIOWwj+WchueCuQogICAgLy8gbGV0IHRvdGFsID0gMAogICAgLy8gLy8gIOaAu+S7tyDmgLvorqEKICAgIC8vIGxldCBwcmljZSA9IDAKICAgIC8vIC8vIOaYr+WQpuWFqOmDqOmAieS4rSAKICAgIC8vIGxldCBhbGxDaGVja2VkID0gdHJ1ZSAvLyDpu5jorqTlhajpgIkKCiAgICBpZiAocHJvZHVjdExpc3QpIHsKICAgICAgZm9yICh2YXIgaSBpbiBwcm9kdWN0TGlzdCkgewogICAgICAgIHZhciBwcm9kdWN0ID0gcHJvZHVjdExpc3RbaV07CiAgICAgICAgcmVzdWx0LnRvdGFsICs9IHByb2R1Y3QuY291bnQ7CgogICAgICAgIGlmIChwcm9kdWN0LmNoZWNrKSB7CiAgICAgICAgICByZXN1bHQucHJpY2UgKz0gcHJvZHVjdC5jb3VudCAqIHByb2R1Y3QucHJpY2U7CiAgICAgICAgfQoKICAgICAgICBpZiAocHJvZHVjdC5jb3VudCA+IDAgJiYgIXByb2R1Y3QuY2hlY2spIHsKICAgICAgICAgIHJlc3VsdC5hbGxDaGVja2VkID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmVzdWx0LnByaWNlID0gcmVzdWx0LnByaWNlLnRvRml4ZWQoMik7CiAgICByZXR1cm4gcmVzdWx0OwogIH0pOwogIHJldHVybiB7CiAgICBjaGFuZ2VDYXJ0SXRlbUluZm86IGNoYW5nZUNhcnRJdGVtSW5mbywKICAgIGNhcnRMaXN0OiBjYXJ0TGlzdCwKICAgIHByb2R1Y3RMaXN0OiBwcm9kdWN0TGlzdCwKICAgIHNob3BOYW1lOiBzaG9wTmFtZSwKICAgIGNhbGN1bGF0aW9uczogY2FsY3VsYXRpb25zCiAgfTsKfTs="},{"version":3,"names":["useStore","computed","useCommonCartEffect","shopId","store","cartList","state","productList","notEmptyProductList","i","product","count","shopName","changeCartItemInfo","productId","productInfo","num","commit","calculations","result","total","price","allChecked","check","toFixed"],"sources":["C:/Users/我是仙女/Desktop/jd/src/effects/cartEffect.js"],"sourcesContent":["import { useStore } from 'vuex'\r\nimport { computed } from 'vue'\r\n\r\n// 购物车相关逻辑  点击加减号\r\nexport const useCommonCartEffect = (shopId) => {\r\n    const store = useStore()\r\n    const cartList = store.state.cartList\r\n\r\n    // 获取购物车数据\r\n    const productList = computed(() => {\r\n        const productList = cartList[shopId]?.productList || {}\r\n        // console.log(productList)\r\n        const notEmptyProductList = {}\r\n        for (const i in productList) {\r\n            const product = productList[i]\r\n            if (product.count > 0) {\r\n                notEmptyProductList[i] = product\r\n            }\r\n        }\r\n        return productList\r\n    })\r\n\r\n    // 获取shopName\r\n    const shopName = computed(() => {\r\n        const shopName = cartList[shopId]?.shopName || ''\r\n        return shopName\r\n    })\r\n\r\n    const changeCartItemInfo = (shopId, productId, productInfo, num) => {\r\n        // console.log(shopId) \r\n        // commit 同步修改数据\r\n        store.commit('changeCartItemInfo', { shopId, productId, productInfo, num })\r\n    }\r\n\r\n    // 优化多次用到的productList\r\n    const calculations = computed(() => {\r\n        const productList = cartList[shopId]?.productList\r\n        const result = { total: 0, price: 0, allChecked: true }\r\n        // 总件数 小圆点\r\n        // let total = 0\r\n        // //  总价 总计\r\n        // let price = 0\r\n        // // 是否全部选中 \r\n        // let allChecked = true // 默认全选\r\n        if (productList) {\r\n            for (const i in productList) {\r\n                const product = productList[i]\r\n                result.total += product.count\r\n                if (product.check) {\r\n                    result.price += product.count * product.price\r\n                }\r\n                if (product.count > 0 && !product.check) {\r\n                    result.allChecked = false\r\n                }\r\n            }\r\n        }\r\n        result.price = result.price.toFixed(2)\r\n        return result\r\n    })\r\n    return { changeCartItemInfo, cartList, productList, shopName, calculations }\r\n}\r\n"],"mappings":";AAAA,SAASA,QAAT,QAAyB,MAAzB;AACA,SAASC,QAAT,QAAyB,KAAzB,C,CAEA;;AACA,OAAO,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,MAAD,EAAY;EAC3C,IAAMC,KAAK,GAAGJ,QAAQ,EAAtB;EACA,IAAMK,QAAQ,GAAGD,KAAK,CAACE,KAAN,CAAYD,QAA7B,CAF2C,CAI3C;;EACA,IAAME,WAAW,GAAGN,QAAQ,CAAC,YAAM;IAAA;;IAC/B,IAAMM,WAAW,GAAG,qBAAAF,QAAQ,CAACF,MAAD,CAAR,sEAAkBI,WAAlB,KAAiC,EAArD,CAD+B,CAE/B;;IACA,IAAMC,mBAAmB,GAAG,EAA5B;;IACA,KAAK,IAAMC,CAAX,IAAgBF,WAAhB,EAA6B;MACzB,IAAMG,OAAO,GAAGH,WAAW,CAACE,CAAD,CAA3B;;MACA,IAAIC,OAAO,CAACC,KAAR,GAAgB,CAApB,EAAuB;QACnBH,mBAAmB,CAACC,CAAD,CAAnB,GAAyBC,OAAzB;MACH;IACJ;;IACD,OAAOH,WAAP;EACH,CAX2B,CAA5B,CAL2C,CAkB3C;;EACA,IAAMK,QAAQ,GAAGX,QAAQ,CAAC,YAAM;IAAA;;IAC5B,IAAMW,QAAQ,GAAG,sBAAAP,QAAQ,CAACF,MAAD,CAAR,wEAAkBS,QAAlB,KAA8B,EAA/C;IACA,OAAOA,QAAP;EACH,CAHwB,CAAzB;;EAKA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACV,MAAD,EAASW,SAAT,EAAoBC,WAApB,EAAiCC,GAAjC,EAAyC;IAChE;IACA;IACAZ,KAAK,CAACa,MAAN,CAAa,oBAAb,EAAmC;MAAEd,MAAM,EAANA,MAAF;MAAUW,SAAS,EAATA,SAAV;MAAqBC,WAAW,EAAXA,WAArB;MAAkCC,GAAG,EAAHA;IAAlC,CAAnC;EACH,CAJD,CAxB2C,CA8B3C;;;EACA,IAAME,YAAY,GAAGjB,QAAQ,CAAC,YAAM;IAAA;;IAChC,IAAMM,WAAW,wBAAGF,QAAQ,CAACF,MAAD,CAAX,sDAAG,kBAAkBI,WAAtC;IACA,IAAMY,MAAM,GAAG;MAAEC,KAAK,EAAE,CAAT;MAAYC,KAAK,EAAE,CAAnB;MAAsBC,UAAU,EAAE;IAAlC,CAAf,CAFgC,CAGhC;IACA;IACA;IACA;IACA;IACA;;IACA,IAAIf,WAAJ,EAAiB;MACb,KAAK,IAAME,CAAX,IAAgBF,WAAhB,EAA6B;QACzB,IAAMG,OAAO,GAAGH,WAAW,CAACE,CAAD,CAA3B;QACAU,MAAM,CAACC,KAAP,IAAgBV,OAAO,CAACC,KAAxB;;QACA,IAAID,OAAO,CAACa,KAAZ,EAAmB;UACfJ,MAAM,CAACE,KAAP,IAAgBX,OAAO,CAACC,KAAR,GAAgBD,OAAO,CAACW,KAAxC;QACH;;QACD,IAAIX,OAAO,CAACC,KAAR,GAAgB,CAAhB,IAAqB,CAACD,OAAO,CAACa,KAAlC,EAAyC;UACrCJ,MAAM,CAACG,UAAP,GAAoB,KAApB;QACH;MACJ;IACJ;;IACDH,MAAM,CAACE,KAAP,GAAeF,MAAM,CAACE,KAAP,CAAaG,OAAb,CAAqB,CAArB,CAAf;IACA,OAAOL,MAAP;EACH,CAvB4B,CAA7B;EAwBA,OAAO;IAAEN,kBAAkB,EAAlBA,kBAAF;IAAsBR,QAAQ,EAARA,QAAtB;IAAgCE,WAAW,EAAXA,WAAhC;IAA6CK,QAAQ,EAARA,QAA7C;IAAuDM,YAAY,EAAZA;EAAvD,CAAP;AACH,CAxDM"}]}