{"remainingRequest":"C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\vue-loader-v16\\dist\\templateLoader.js??ref--6!C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\我是仙女\\Desktop\\jd\\src\\views\\orderConfirmation\\Order.vue?vue&type=template&id=2258ba98&scoped=true","dependencies":[{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\src\\views\\orderConfirmation\\Order.vue","mtime":1655730414398},{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\babel.config.js","mtime":1654581884108},{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1654581870855},{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\babel-loader\\lib\\index.js","mtime":1654581871710},{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1654581872259},{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1654581870855},{"path":"C:\\Users\\我是仙女\\Desktop\\jd\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1654581871863}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgdG9EaXNwbGF5U3RyaW5nIGFzIF90b0Rpc3BsYXlTdHJpbmcsIGNyZWF0ZUVsZW1lbnRWTm9kZSBhcyBfY3JlYXRlRWxlbWVudFZOb2RlLCBjcmVhdGVUZXh0Vk5vZGUgYXMgX2NyZWF0ZVRleHRWTm9kZSwgd2l0aE1vZGlmaWVycyBhcyBfd2l0aE1vZGlmaWVycywgdlNob3cgYXMgX3ZTaG93LCB3aXRoRGlyZWN0aXZlcyBhcyBfd2l0aERpcmVjdGl2ZXMsIEZyYWdtZW50IGFzIF9GcmFnbWVudCwgb3BlbkJsb2NrIGFzIF9vcGVuQmxvY2ssIGNyZWF0ZUVsZW1lbnRCbG9jayBhcyBfY3JlYXRlRWxlbWVudEJsb2NrLCBwdXNoU2NvcGVJZCBhcyBfcHVzaFNjb3BlSWQsIHBvcFNjb3BlSWQgYXMgX3BvcFNjb3BlSWQgfSBmcm9tICJ2dWUiOwoKdmFyIF93aXRoU2NvcGVJZCA9IGZ1bmN0aW9uIF93aXRoU2NvcGVJZChuKSB7CiAgcmV0dXJuIF9wdXNoU2NvcGVJZCgiZGF0YS12LTIyNThiYTk4IiksIG4gPSBuKCksIF9wb3BTY29wZUlkKCksIG47Cn07Cgp2YXIgX2hvaXN0ZWRfMSA9IHsKICBjbGFzczogIm9yZGVyIgp9Owp2YXIgX2hvaXN0ZWRfMiA9IHsKICBjbGFzczogIm9yZGVyX19wcmljZSIKfTsKCnZhciBfaG9pc3RlZF8zID0gLyojX19QVVJFX18qL19jcmVhdGVUZXh0Vk5vZGUoIiDlrp7ku5jph5Hpop0gwqAiKTsKCnZhciBfaG9pc3RlZF80ID0gLyojX19QVVJFX18qL193aXRoU2NvcGVJZChmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIC8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJoMyIsIHsKICAgIGNsYXNzOiAibWFza19fY29udGVudF9fdGl0bGUiCiAgfSwgIuehruiupOimgeemu+W8gOaUtumTtuWPsO+8nyIsIC0xCiAgLyogSE9JU1RFRCAqLwogICk7Cn0pOwoKdmFyIF9ob2lzdGVkXzUgPSAvKiNfX1BVUkVfXyovX3dpdGhTY29wZUlkKGZ1bmN0aW9uICgpIHsKICByZXR1cm4gLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoInAiLCB7CiAgICBjbGFzczogIm1hc2tfX2NvbnRlbnRfX2Rlc2MiCiAgfSwgIuivt+WwveW/q+WujOaIkOaUr+S7mO+8jOWQpuWImeWwhuiiq+WPlua2iCIsIC0xCiAgLyogSE9JU1RFRCAqLwogICk7Cn0pOwoKdmFyIF9ob2lzdGVkXzYgPSB7CiAgY2xhc3M6ICJtYXNrX19jb250ZW50X19idG5zIgp9OwpleHBvcnQgZnVuY3Rpb24gcmVuZGVyKF9jdHgsIF9jYWNoZSwgJHByb3BzLCAkc2V0dXAsICRkYXRhLCAkb3B0aW9ucykgewogIHJldHVybiBfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soX0ZyYWdtZW50LCBudWxsLCBbX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfMSwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIF9ob2lzdGVkXzIsIFtfaG9pc3RlZF8zLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJiIiwgbnVsbCwgIiDCpSIgKyBfdG9EaXNwbGF5U3RyaW5nKCRzZXR1cC5jYWxjdWxhdGlvbnMucHJpY2UpLCAxCiAgLyogVEVYVCAqLwogICldKSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgewogICAgY2xhc3M6ICJvcmRlcl9fYnRuIiwKICAgIG9uQ2xpY2s6IF9jYWNoZVswXSB8fCAoX2NhY2hlWzBdID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gJHNldHVwLmhhbmRsZVNob3dDb25maXJtQ2hhbmdlKHRydWUpOwogICAgfSkKICB9LCAiIOaPkOS6pOiuouWNlSAiKV0pLCBfd2l0aERpcmVjdGl2ZXMoX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgewogICAgY2xhc3M6ICJtYXNrIiwKICAgIG9uQ2xpY2s6IF9jYWNoZVs0XSB8fCAoX2NhY2hlWzRdID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gJHNldHVwLmhhbmRsZVNob3dDb25maXJtQ2hhbmdlKGZhbHNlKTsKICAgIH0pCiAgfSwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIHsKICAgIGNsYXNzOiAibWFza19fY29udGVudCIsCiAgICBvbkNsaWNrOiBfY2FjaGVbM10gfHwgKF9jYWNoZVszXSA9IF93aXRoTW9kaWZpZXJzKGZ1bmN0aW9uICgpIHt9LCBbInN0b3AiXSkpCiAgfSwgW19ob2lzdGVkXzQsIF9ob2lzdGVkXzUsIF9jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIF9ob2lzdGVkXzYsIFtfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCB7CiAgICBjbGFzczogIm1hc2tfX2NvbnRlbnRfX2J0biBtYXNrX19jb250ZW50X19idG4tLWZpcnN0IiwKICAgIG9uQ2xpY2s6IF9jYWNoZVsxXSB8fCAoX2NhY2hlWzFdID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gJHNldHVwLmhhbmRsZUNvbmZpcm1sT3JkZXIodHJ1ZSk7CiAgICB9KQogIH0sICIg5Y+W5raI6K6i5Y2VICIpLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCB7CiAgICBjbGFzczogIm1hc2tfX2NvbnRlbnRfX2J0biBtYXNrX19jb250ZW50X19idG4tLWxhc3QiLAogICAgb25DbGljazogX2NhY2hlWzJdIHx8IChfY2FjaGVbMl0gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAkc2V0dXAuaGFuZGxlQ29uZmlybWxPcmRlcihmYWxzZSk7CiAgICB9KQogIH0sICIg56Gu6K6k5pSv5LuYICIpXSldKV0sIDUxMgogIC8qIE5FRURfUEFUQ0ggKi8KICApLCBbW192U2hvdywgJHNldHVwLnNob3dDb25maXJtXV0pXSwgNjQKICAvKiBTVEFCTEVfRlJBR01FTlQgKi8KICApOwp9"},{"version":3,"mappings":";;;;;;;EACOA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;+CAAe;;;sBAaxBC,oBAA+C,IAA/C,EAA+C;IAA3CD,KAAK,EAAC;EAAqC,CAA/C,EAAiC,WAAjC,EAA0C;EAAA;EAA1C;;;;sBACAC,oBAAiD,GAAjD,EAAiD;IAA9CD,KAAK,EAAC;EAAwC,CAAjD,EAA+B,gBAA/B,EAA6C;EAAA;EAA7C;;;;EACKA,KAAK,EAAC;;;6DAhBfC,oBAOM,KAPN,cAOM,CANJA,oBAEM,KAFN,cAEM,aADOA,oBAAqC,GAArC,EAAqC,IAArC,EAAG,OAAMC,iBAAGC,oBAAaC,KAAhB,CAAT,EAA8B;EAAA;EAA9B,CACP,CAFN,CAMI,EAHJH,oBAEM,KAFN,EAEM;IAFDD,KAAK,EAAC,YAEL;IAFmBK,OAAK;MAAA,OAAQF,+BAAuB,IAAvB,CAAR;IAAA;EAExB,CAFN,EAAqE,QAArE,CAGI,CAPN,mBAQAF,oBAuBM,KAvBN,EAuBM;IAtBJD,KAAK,EAAC,MAsBF;IApBHK,OAAK;MAAA,OAAQF,+BAAuB,KAAvB,CAAR;IAAA;EAoBF,CAvBN,GAKEF,oBAiBM,KAjBN,EAiBM;IAjBDD,KAAK,EAAC,eAiBL;IAjBsBK,OAAK,2CAAN,aAAW,CAAL,EAAK,QAAL;EAiB3B,CAjBN,GACEC,YACAC,YACAN,oBAaM,KAbN,cAaM,CAZJA,oBAKM,KALN,EAKM;IAJJD,KAAK,EAAC,8CAIF;IAHHK,OAAK;MAAA,OAAQF,2BAAmB,IAAnB,CAAR;IAAA;EAGF,CALN,EAGC,QAHD,CAYI,EANJF,oBAKM,KALN,EAKM;IAJJD,KAAK,EAAC,6CAIF;IAHHK,OAAK;MAAA,OAAQF,2BAAmB,KAAnB,CAAR;IAAA;EAGF,CALN,EAGC,QAHD,CAMI,CAbN,EAHF,EALF;;EAAA,aAEUA","names":["class","_createElementVNode","_toDisplayString","$setup","price","onClick","_hoisted_4","_hoisted_5"],"sourceRoot":"","sources":["C:\\Users\\我是仙女\\Desktop\\jd\\src\\views\\orderConfirmation\\Order.vue"],"sourcesContent":["<template>\r\n  <div class=\"order\">\r\n    <div class=\"order__price\">\r\n      实付金额 &nbsp;<b> &yen;{{ calculations.price }}</b>\r\n    </div>\r\n    <div class=\"order__btn\" @click=\"() => handleShowConfirmChange(true)\">\r\n      提交订单\r\n    </div>\r\n  </div>\r\n  <div\r\n    class=\"mask\"\r\n    v-show=\"showConfirm\"\r\n    @click=\"() => handleShowConfirmChange(false)\"\r\n  >\r\n    <div class=\"mask__content\" @click.stop>\r\n      <h3 class=\"mask__content__title\">确认要离开收银台？</h3>\r\n      <p class=\"mask__content__desc\">请尽快完成支付，否则将被取消</p>\r\n      <div class=\"mask__content__btns\">\r\n        <div\r\n          class=\"mask__content__btn mask__content__btn--first\"\r\n          @click=\"() => handleConfirmlOrder(true)\"\r\n        >\r\n          取消订单\r\n        </div>\r\n        <div\r\n          class=\"mask__content__btn mask__content__btn--last\"\r\n          @click=\"() => handleConfirmlOrder(false)\"\r\n        >\r\n          确认支付\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n\r\nimport { useCommonCartEffect } from '../../effects/cartEffect'\r\nimport { post } from '../../utils/request'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\nimport { ref } from 'vue'\r\n\r\n// 下单相关\r\nconst useMakeOrderEffect = (shopName, productList, shopId) => {\r\n  console.log(2, productList)\r\n  const router = useRouter()\r\n  const store = useStore()\r\n\r\n  const handleConfirmlOrder = async (isCanceled) => {\r\n    console.log(3, productList)\r\n    // console.log(123)\r\n    // 在store中，getLocalCartList 里面，productList 是对象形式，此处接口数据中，products是一个数组，要通过对象循环去构建products   \r\n    const products = []\r\n    for (const i in productList.value) {\r\n      const product = productList.value[i]\r\n      products.push({ id: parseInt(product._id, 10), num: product.count })\r\n      // console.log(product)\r\n    }\r\n\r\n    try {\r\n      const result = await post('/api/order', {\r\n        addressId: 1,\r\n        shopId,\r\n        shopName: shopName.value,\r\n        isCanceled,\r\n        products\r\n      })\r\n      console.log(result)\r\n      if (result?.errno === 0) {\r\n        store.commit('clearCartData', { shopId })\r\n        router.push({ name: 'OrderList' })\r\n      } else {\r\n        // showToast('确认失败')\r\n      }\r\n    } catch (e) {\r\n      // showToast('请求失败')\r\n    }\r\n  }\r\n  return { handleConfirmlOrder }\r\n}\r\n\r\n// 弹层展示相关\r\nconst useShowMaskEfect = () => {\r\n  const showConfirm = ref(false)\r\n  const handleShowConfirmChange = (status) => {\r\n    showConfirm.value = status\r\n  }\r\n  return { showConfirm, handleShowConfirmChange }\r\n}\r\nexport default {\r\n  name: 'Order',\r\n  setup() {\r\n    const route = useRoute()\r\n    const shopId = parseInt(route.params.id, 10)\r\n    const { calculations, shopName, productList } = useCommonCartEffect(shopId)\r\n    console.log(1, productList)\r\n    const { handleConfirmlOrder } = useMakeOrderEffect(shopName, productList, shopId)\r\n    const { showConfirm, handleShowConfirmChange } = useShowMaskEfect()\r\n    return {\r\n      calculations, handleConfirmlOrder, showConfirm, handleShowConfirmChange\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../../style/mixins';\r\n@import '../../style/viriables';\r\n.order {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  height: 0.49rem;\r\n  line-height: 0.49rem;\r\n  font-size: 0.14rem;\r\n  background-color: $bgColor;\r\n  &__price {\r\n    flex: 1;\r\n    text-indent: 0.24rem;\r\n    color: $content-fontcolor;\r\n  }\r\n  &__btn {\r\n    width: 0.98rem;\r\n    background-color: #4fb0f9;\r\n    color: $bgColor;\r\n    text-align: center;\r\n  }\r\n}\r\n.mask {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  top: 0;\r\n  z-index: 1;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  &__content {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 3rem;\r\n    height: 1.6rem;\r\n    background-color: #ffffff;\r\n    border-radius: 0.04rem;\r\n    text-align: center;\r\n    &__title {\r\n      font-size: 0.18rem;\r\n      color: #333333;\r\n      margin: 0.24rem 0 0 0;\r\n      line-height: 0.26rem;\r\n    }\r\n    &__desc {\r\n      font-size: 0.14rem;\r\n      color: #666666;\r\n      line-height: 0.2rem;\r\n      margin: 0.08rem 0 0 0;\r\n    }\r\n    &__btns {\r\n      margin: 0.24rem 0.58rem;\r\n      display: flex;\r\n    }\r\n    &__btn {\r\n      flex: 1;\r\n      width: 0.8rem;\r\n      line-height: 0.32rem;\r\n      border: 0.01rem solid #4fb0f9;\r\n      border-radius: 0.16rem;\r\n      font-size: 0.14rem;\r\n      &--first {\r\n        color: #0091ff;\r\n        margin-right: 0.12rem;\r\n      }\r\n      &--last {\r\n        background-color: #4fb0f9;\r\n        color: #ffffff;\r\n        margin-left: 0.12rem;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}